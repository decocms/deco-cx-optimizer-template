{
  "name": "11. Image Optimization: Using Image & Picture Components",
  "description": "Complete guide to using deco's Image and Picture components with proper width/height, preloading, lazy loading, and LCP optimization strategies.",
  "content": "---\ndescription: Learn how to use images on your website without sacrificing performance.\n---\n\n## Summary\n\n> Deco provides Image, Picture, and Source components to work with images. These\n> components add responsive patterns to speed up your site. To add an image to\n> your site:\n>\n> 1. Add the deco image components (`<Image/>`, `<Source>`, `<Picture>`) to your\n>    code\n> 2. Style the components with CSS until you achieve the desired appearance\n> 3. Set the width and height attributes of the component.\n\n> The deco components already provide:\n>\n> - Responsive images for all screen sizes\n> - Preloading tags to improve LCP\n> - Image processing to optimize image size\n\n## Image or Picture\n\nThere are two components for displaying images: `<Image>` and `<Picture>`. The\nappropriate component depends on your use case:\n\n- `<Image>` displays an image (internally using `<img>`) and is useful for\n  images that always have the same aspect ratio (width vs height) regardless of\n  screen size.\n\n<Frame><img alt=\"Image component as a product image\" src=\"https://deco.cx/docs/image-aspect-ratio.png\"/></Frame>\n\n- `<Picture>` defines images that can vary in size according to the screen\n  resolution.\n\n<Frame><img alt=\"Picture component as a banner image\" src=\"https://deco.cx/docs/picture-aspect-ratio.png\"/></Frame>\n\n## Adding an image\n\nUsing the appropriate component, style it with Tailwind classes. It is mandatory\nto set the src and use the height/width props:\n\n```tsx\nimport Image from \"apps/website/components/Image.tsx\";\n\nexport default function MeuComponente() {\n  return (\n    <Image\n      src=\"https://example.com/image.png\"\n      class=\"w-full h-full object-cover\"\n      width={800}\n      height={1200}\n    />\n  );\n}\n```\n\nThe width/height does not change the size of the image on the screen as it is\nstyled by CSS. These attributes don't even need to be the original size of the\nimage. The height and width are present to allow the server and browser to\nchoose the appropriate image to download based on the user's screen resolution.\n\n## Adding a Picture\n\nBelow, you will find a minimal example that renders an image for desktop and\nanother one for mobile devices.\n\n```tsx\nimport { Picture, Source } from \"apps/website/components/Picture.tsx\";\n\nfunction MeuComponente() {\n  return (\n    <Picture>\n      <Source\n        media=\"(max-width: 768px)\"\n        src=\"https://example.com/image-mobile.png\"\n        width={270}\n        height={377}\n      />\n      <Source\n        media=\"(min-width: 768px)\"\n        src=\"https://example.com/image-desktop.png\"\n        width={800}\n        height={1200}\n      />\n      <img\n        src=\"https://example.com/image-desktop.png\"\n        alt=\"Image description\"\n        class=\"w-full h-full object-cover\"\n      />\n    </Picture>\n  );\n}\n```\n\n> Note that you should use the `<Frame><img>` tag inside Picture, not the `<Image/></Frame>`\n> component. Also note that the `src` attribute in the `<img>` tag is REQUIRED\n> and should receive the larger image, in this case, the desktop image.\n\nThe example above renders the `/image-mobile.png` image for screen sizes up to\n768px wide. For larger screen sizes, the `/image-desktop.png` image will be\nrendered.\n\nTo style this image, add classes to the `<img>` tag. For example, to make the\nimage fill the available space, as shown in the example above.\n\n## Finding the width and height properties\n\nThe `width` and `height` attributes of the image can be confusing, even for\nexperienced developers. This confusion arises from the fact that these\nattributes DO NOT change the final size of the rendered image on the screen.\nInstead, they affect the image that the browser will download in a responsive\nimage scenario. Choosing appropriate width and height values is key to\ndownloading a small image for good LCP results.\n\nTo find a good width and height value:\n\n1. Open your website and inspect the image element.\n2. Set the viewport to the desired size (412px for mobile devices or 1440px for\n   desktop).\n3. Hover over the image tag. You should see something like:\n   <Frame><img alt=\"Image properties in the browser inspector\" src=\"https://deco.cx/docs/width-attribute.png\" /></Frame>\n4. Voil√†! A good width and height value is available in the \"Rendered size\"\n   attribute. In this case, the `width` is 270px and the `height` is 377px.\n\n## Loading images in an optimized way (improving LCP)\n\nFor a good LCP, not only do you need to send small payloads, but you also need\nto load them in the correct order, prioritizing those that are visible on the\nscreen over other elements (below the fold). A good heuristic is:\n\n1. Prioritize the LCP image.\n2. Lazy load all other images.\n\nFortunately, the `<Image>` and `<Picture>` components from Deco help us achieve\nthis behavior. Start by identifying the largest element on the screen (LCP).\nThen, open the component's code and check if:\n\n1. The `preload` attribute is set.\n2. The `loading` attribute is set to 'eager'.\n3. The `fetchPriority` attribute is set to 'high'.\n\nFor example, for an `<Image/>` component:\n\n```tsx\nimport Image from \"apps/website/components/Image.tsx\";\n\nexport default function MyComponent() {\n  return (\n    <Image\n      src=\"https://example.com/image.png\"\n      width={270}\n      height={377}\n      preload\n      loading=\"eager\"\n      fetchPriority=\"high\"\n    />\n  );\n}\n```\n\nFor a `<Picture/>`:\n\n```tsx\nimport { Picture, Source } from \"apps/website/components/Picture.tsx\";\n\nfunction MyComponent() {\n  return (\n    <Picture preload>\n      <Source\n        media=\"(max-width: 768px)\"\n        src=\"https://example.com/image-mobile.png\"\n        width={270}\n        height={377}\n      />\n      <Source\n        media=\"(min-width: 768px)\"\n        src=\"https://example.com/image-desktop.png\"\n        width={800}\n        height={1200}\n      />\n      <img\n        loading=\"eager\"\n        fetchPriority=\"high\"\n        src=\"https://example.com/image-desktop.png\"\n        class=\"w-full h-full object-cover\"\n      />\n    </Picture>\n  );\n}\n```\n\nMake sure that other images do not have the `preload` attribute and have the\n`loading=\"lazy\"` and `fetchPriority=\"low\"` attributes. By adding these\nconfigurations, you will optimize the image loading to improve LCP.\n\n> **Tip**: The final page should have only <u>one preloaded image</u>.\n> Preloading multiple images worsens the LCP score. To verify that only one\n> image is being preloaded, check that there is only one `<link rel=\"preload\"/>`\n> tag.\n\n## Relevant sources\n\n- [LCP](https://web.dev/lcp/)\n- [Aspect-ratio CSS](https://www.w3schools.com/cssref/css_pr_aspect-ratio.php)\n"
}